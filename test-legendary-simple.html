<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simple Legendary Test</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: monospace; }
        #info { position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.8); padding: 15px; z-index: 1000; border: 2px solid #0f0; }
        button { display: block; margin: 5px 0; padding: 10px; background: #0f0; border: none; color: #000; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <div id="info">
        <h3>üåü Legendary Mode Test</h3>
        <button onclick="step1()">1Ô∏è‚É£ Collect All Parts</button>
        <button onclick="step2()">2Ô∏è‚É£ Equip Legendary</button>
        <button onclick="step3()">3Ô∏è‚É£ Start Game</button>
        <div id="status" style="margin-top: 10px; padding: 10px; background: #111;"></div>
    </div>

    <script src="js/utils/SaveSystem.js"></script>
    <script src="js/utils/Controls.js"></script>
    <script src="js/entities/Player.js"></script>
    <script src="js/entities/Enemy.js"></script>
    <script src="js/entities/Collectible.js"></script>
    <script src="js/scenes/MenuScene.js"></script>
    <script src="js/scenes/GameScene.js"></script>
    <script src="js/scenes/CraftScene.js"></script>
    <script src="js/game.js"></script>

    <script>
        function updateStatus(msg) {
            const el = document.getElementById('status');
            el.innerHTML += msg + '<br>';
            console.log(msg);
        }

        function step1() {
            updateStatus('üì¶ Collecting all robot parts...');
            window.gameInstance.addRobotPart('head', 'common');
            window.gameInstance.addRobotPart('body', 'common');
            window.gameInstance.addRobotPart('arms', 'common');
            window.gameInstance.addRobotPart('legs', 'common');
            window.gameInstance.addRobotPart('powerCore', 'common');
            
            const unlocks = window.gameInstance.checkDragonUnlocks();
            updateStatus('üîì Unlocked: ' + unlocks.join(', '));
            
            const isUnlocked = window.gameInstance.gameData.outfits.unlocked.includes('legendary');
            updateStatus('‚úÖ Legendary unlocked: ' + isUnlocked);
        }

        function step2() {
            updateStatus('‚ö° Equipping legendary mode...');
            const before = window.gameInstance.gameData.outfits.current;
            updateStatus('   Before: ' + before);
            
            window.gameInstance.setOutfit('legendary');
            
            const after = window.gameInstance.gameData.outfits.current;
            updateStatus('   After: ' + after);
            
            const costume = window.gameInstance.getDragonCostume(after);
            updateStatus('   IsLegendary: ' + costume.isLegendary);
        }

        function step3() {
            updateStatus('üéÆ Starting game...');
            window.gameInstance.game.scene.start('GameScene');
            
            setTimeout(() => {
                const scene = window.gameInstance.game.scene.getScene('GameScene');
                if (scene && scene.player) {
                    const costume = scene.player.getDragonCostume();
                    updateStatus('üé® Player created with: ' + costume.name);
                    updateStatus('   IsLegendary: ' + costume.isLegendary);
                    updateStatus('   Sprite type: ' + (scene.player.sprite.type === 'Container' ? 'Container (‚úÖ CORRECT!)' : scene.player.sprite.type));
                } else {
                    updateStatus('‚ùå No player found!');
                }
            }, 1000);
        }

        // Auto-status on load
        setTimeout(() => {
            updateStatus('üéÆ Game loaded');
            updateStatus('Current outfit: ' + window.gameInstance.gameData.outfits.current);
        }, 2000);
    </script>
</body>
</html>

