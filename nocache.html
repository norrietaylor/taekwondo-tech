<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•ã Taekwondo Robot Builder - No Cache</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #2c5f5d, #1a3d3b);
            font-family: 'Arial', sans-serif;
            color: white;
            overflow: hidden;
        }
        canvas {
            display: block;
            margin: 0 auto;
            border: 2px solid #1a3d3b;
            border-radius: 8px;
        }
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 1000;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div id="loading">
        <h2>üéÆ Loading Game...</h2>
        <p>Cache-busted version</p>
    </div>

    <!-- Phaser.js -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
    
    <!-- Game scripts with cache busting -->
    <script>
        const cacheBuster = Date.now();
        const scripts = [
            'js/utils/Controls.js',
            'js/utils/SaveSystem.js',
            'js/entities/Player.js',
            'js/entities/Enemy.js',
            'js/entities/Collectible.js',
            'js/scenes/MenuScene.js',
            'js/scenes/GameScene.js',
            'js/scenes/CraftScene.js',
            'js/game.js'
        ];

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = `${src}?v=${cacheBuster}`;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        async function loadAllScripts() {
            console.log('üîÑ Loading scripts with cache buster:', cacheBuster);
            
            for (const scriptSrc of scripts) {
                try {
                    console.log('Loading:', scriptSrc);
                    await loadScript(scriptSrc);
                    console.log('‚úÖ Loaded:', scriptSrc);
                } catch (error) {
                    console.error('‚ùå Failed to load:', scriptSrc, error);
                }
            }
            
            console.log('üéÆ All scripts loaded, initializing game...');
            document.getElementById('loading').classList.add('hidden');
            
            // Initialize game
            setTimeout(() => {
                try {
                    console.log('TaekwondoRobotBuilder available:', typeof TaekwondoRobotBuilder);
                    const game = new TaekwondoRobotBuilder();
                    game.init();
                    console.log('‚úÖ Game initialized successfully');
                } catch (error) {
                    console.error('üí• Game initialization failed:', error);
                    document.body.innerHTML += `
                        <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                                   background: #ff4444; color: white; padding: 20px; border-radius: 8px; 
                                   font-family: Arial, sans-serif; z-index: 10000;">
                            <h3>‚ùå Game Error</h3>
                            <p><strong>Error:</strong> ${error.message}</p>
                            <details>
                                <summary>Stack Trace</summary>
                                <pre style="font-size: 12px; margin-top: 10px;">${error.stack}</pre>
                            </details>
                        </div>
                    `;
                }
            }, 100);
        }

        // Load scripts when page is ready
        window.addEventListener('load', loadAllScripts);
    </script>
</body>
</html>
